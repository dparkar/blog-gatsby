<!DOCTYPE html><html><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/blog-gatsby/component---src-layouts-index-js-2abfc667c37e6263bd01.js" as="script"/><link rel="preload" href="/blog-gatsby/component---src-templates-log-js-b4a7d74ce313b46c6d85.js" as="script"/><link rel="preload" href="/blog-gatsby/path---cs-unit-testing-private-methods-cd7c2632587ad9a45f15.js" as="script"/><link rel="preload" href="/blog-gatsby/app-930d4525f9a0912207a7.js" as="script"/><link rel="preload" href="/blog-gatsby/commons-8b3777e9b7196ecd4564.js" as="script"/><title data-react-helmet="true">C# : Unit Testing Private Methods</title><style id="gatsby-inlined-css">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:112.5%/1.45em georgia,serif;box-sizing:border-box;overflow-y:scroll}*,:after,:before{box-sizing:inherit}body{color:rgba(0,0,0,.8);font-family:georgia,serif;font-weight:400;word-wrap:break-word;-webkit-font-kerning:normal;font-kerning:normal;-ms-font-feature-settings:"kern","liga","clig","calt";-webkit-font-feature-settings:"kern","liga","clig","calt";font-feature-settings:"kern","liga","clig","calt","kern"}img{max-width:100%;margin:0 0 1.45rem;padding:0}h1{font-size:2.25rem}h1,h2{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h2{font-size:1.62671rem}h3{font-size:1.38316rem}h3,h4{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h4{font-size:1rem}h5{font-size:.85028rem}h5,h6{margin:0 0 1.45rem;padding:0;color:inherit;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:700;text-rendering:optimizeLegibility;line-height:1.1}h6{font-size:.78405rem}hgroup{margin:0 0 1.45rem;padding:0}ol,ul{margin:0 0 1.45rem 1.45rem;padding:0;list-style-position:outside;list-style-image:none}dd,dl,figure,p{margin:0 0 1.45rem;padding:0}pre{padding:0;font-size:.85rem;line-height:1.42;background:rgba(0,0,0,.04);border-radius:3px;overflow:auto;word-wrap:normal;padding:1.45rem}pre,table{margin:0 0 1.45rem}table{padding:0;font-size:1rem;line-height:1.45rem;border-collapse:collapse;width:100%}fieldset{margin:0 0 1.45rem;padding:0}blockquote{margin:0 1.45rem 1.45rem;padding:0}form,iframe,noscript{margin:0 0 1.45rem;padding:0}hr{margin:0 0 calc(1.45rem - 1px);padding:0;background:rgba(0,0,0,.2);border:none;height:1px}address{margin:0 0 1.45rem;padding:0}b,dt,strong,th{font-weight:700}li{margin-bottom:.725rem}ol li,ul li{padding-left:0}li>ol,li>ul{margin-left:1.45rem;margin-bottom:.725rem;margin-top:.725rem}blockquote :last-child,li :last-child,p :last-child{margin-bottom:0}li>p{margin-bottom:.725rem}code,kbd,samp{font-size:.85rem;line-height:1.45rem}abbr,abbr[title],acronym{border-bottom:1px dotted rgba(0,0,0,.5);cursor:help}abbr[title]{text-decoration:none}td,th,thead{text-align:left}td,th{border-bottom:1px solid rgba(0,0,0,.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding:.725rem .96667rem calc(.725rem - 1px)}td:first-child,th:first-child{padding-left:0}td:last-child,th:last-child{padding-right:0}code,tt{background-color:rgba(0,0,0,.04);border-radius:3px;font-family:SFMono-Regular,Consolas,Roboto Mono,Droid Sans Mono,Liberation Mono,Menlo,Courier,monospace;padding:0;padding-top:.2em;padding-bottom:.2em}pre code{background:none;line-height:1.42}code:after,code:before,tt:after,tt:before{letter-spacing:-.2em;content:" "}pre code:after,pre code:before,pre tt:after,pre tt:before{content:""}@media only screen and (max-width:480px){html{font-size:100%}}*{background:#f5f5f5;color:#000}body,html{height:100%}body{border:5px solid #ffdb3a}h1{font-size:1.5rem;line-height:.5rem}div,p{font-size:16px}div.blog-post-preview{border-bottom:2px solid #e6e6e6;padding-top:1rem;padding-bottom:1rem;margin-bottom:1rem}h1>*{font-size:1.2rem;-webkit-text-decoration-line:none;text-decoration-line:none}h2{font-size:.8rem!important;font-weight:100!important}</style></head><body><div id="___gatsby"><div data-reactroot="" data-reactid="1" data-react-checksum="-572431619"><div style="background:#f5f5f5;margin-bottom:3rem;border-bottom:2px solid #e6e6e6;" data-reactid="2"><div style="margin:0 auto;max-width:980px;padding:1.45rem 1.0875rem;" data-reactid="3"><h1 style="margin:0;text-align:center;font-size:18px;" data-reactid="4"><a style="color:black;text-decoration:none;" href="/blog-gatsby/" data-reactid="5">dhawal parkar logs ...</a></h1></div></div><div style="margin:0 auto;max-width:980px;display:flex;flex-direction:row;justify-content:space-between;height:100%;" data-reactid="6"><div style="margin:0 auto;max-width:980px;display:flex;flex-direction:row;justify-content:space-between;height:100%;padding:25px;" data-reactid="7"><div style="flex:1;" data-reactid="8"><div class="blog-post-container" data-reactid="9"><!-- react-empty: 10 --><div class="blog-post" data-reactid="11"><div class="blog-post-content" data-reactid="12"><h1>C# : Unit Testing Private Methods</h1>
<p>When a developer writes a piece of code, he(or she) would like to verify and validate that what was just written by him is exactly what he intended to do. How can he be sure ? </p>
<p>One of the possibilities is to run(execute) the code and see the output, which is possible when if its some small program/project. But when you are working on a huge project (e.g. a project with some back ends talking to a database or talking over the wire, a logical layer and multiple GUIs which may be using other assemblies) loading up the whole project and running it to verify if a small functionality is working isn't sensible. This is due to the facts that the project itself may take a long time to load and execute, it may require loading and linking multiple assemblies(.dll) which will take up resources and its an expensive operation. Wasting so much time and resources for a small functionality test is not worth it. And its definitely not sensible when you have to keep testing repetitively.</p>
<p>Instead. a developer can test a piece of his code by writing Unit Tests for that function. Its pretty simple when you are testing public methods.Following is a format for a normal public method of a public class being tested:</p>
<p>If you don't know what is a Unit Test, please take a look <a href="http://en.wikipedia.org/wiki/Unit_testing">here</a></p>
<p>For e.g. :</p>
<pre><code class="language-cs">//The Class you want to test
 
public class foo
{
    .
    .
    .
    //The PUBLIC method you want to test
    public int bar(int c)
    {
        //Logic and result returned
    }
}
 
//In the test class
public class fooTest
{
    //System Under Test (Class foo) whose method needs to be tested
    private static foo _sut = new foo();
    .
    .
    //Test for bar
    //TestMethod is the method attribute which tells CLR that this is a test
    //method and not a normal method
    [TestMethod]
    public void barTest()
    {
        //Arrange (Any arrangement which might be needed before calling the method
        //to test
 
        //Act (The actual call)
        int y = _sut.bar(x);
 
        //Assert for 'y' (Assert the result of the method under test)
    }
}
</code></pre>
<p>If you don't know what is a [TestMethod] attribute, please look <a href="http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute%28VS.80%29.aspx">here</a>.</p>
<p>The above format/set up is only possible if its a public method you are testing. Usually, it makes sense for the developer to test only the public methods. Private helper methods aren't usually tested. </p>
<p>But, there are times when a developer would like to write tests for a private method. This is possible when the private method contains some critical logic which plays an important part in many other public methods. For developer's satisfaction and verification testing private methods may be needed. You can use the built-in MSTest private method testing methods which creates an accessor to the private methods,but that accessor is not compatible to Team Build. In that case, the above set up will require modification. Two different scenarios depending on if you are testing just Private methods or Private Static methods.</p>
<p>If you don't know what is MSTest, please take a look <a href="http://en.wikipedia.org/wiki/MSTest">here</a>.</p>
<p>If you don't know what is Team Build, please take a look <a href="http://en.wikipedia.org/wiki/Team_Foundation_Server">here</a>.</p>
<p>Following is the scenario for a Private Method:</p>
<pre><code class="language-cs">//The Class you want to test
 
public class foo
{
    .
    .
    .
    //The PRIVATE method you want to test
    private int bar(int c)
    {
        //Logic and result returned
    }
}
 
//In the test class
public class fooTest
{
    .
    .
    .
    //Test for bar
    //TestMethod is the method attribute which tells CLR that this is a test
    //method and not a normal method
    [TestMethod]
    public void barTest()
    {
        //Arrange (Any arrangement which might be needed before calling the method
        //to test
 
        //Act (The actual call)
        //Creating an instance of PrivateObject class with the instance of the class
        //whose private method needs to be tested.
        PrivateObject privateObject = new PrivateObject(new foo());
 
        //Invoking the private method
        int y = privateObject.Invoke("bar", intParameter) as Integer;
 
        //Assert for 'y' (Assert the result of the method under test)
    }
}
</code></pre>
<p>If you don't know about PrivateObject, please take a look <a href="http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privateobject%28VS.80%29.aspx">here</a></p>
<p>The private method's name has to be spelled correctly followed by correct no. of parameter. The invocation of the method returns you back an Object which needs to be cast to the expected type.</p>
<p>To test Private Static methods replace the above PrivateObject instance creation with PrivateType as following:</p>
<pre><code class="language-cs">PrivateType privateType = new PrivateType(typeof(foo));
</code></pre>
<p>and invoke the test method like this :</p>
<pre><code class="language-cs">Integer y = (Integer)privateType.InvokeStatic("bar",int someParameter);
</code></pre>
<p>Unit testing has become really popular with the practice of TDD (Test Driven Development).</p>
<p>If you don't know about the PrivateType class, please take a look <a href="http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.privatetype%28VS.80%29.aspx">here</a>.</p>
<p>If you don't know what is TDD, please take a look <a href="http://en.wikipedia.org/wiki/Test-driven_development">here</a>.</p>
<p>Unit tests also act as rules as to what should be expected from a method. Also its a great way of documenting what is expected from the method. A new developer can just look at the tests and see what is to be expected from the method under test.</p></div></div></div></div></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-930d4525f9a0912207a7.js","97625976329170":"component---src-templates-log-js-b4a7d74ce313b46c6d85.js","162898551421021":"component---src-pages-404-js-4503918ea3a16cfcdb75.js","35783957827783":"component---src-pages-index-js-fd4631caf5a350ef62a9.js","218538773642512":"component---src-pages-page-2-js-adcb44fa4e7cefd71b7d.js","60335399758886":"path----557518bd178906f8d58a.js","105328802052025":"path---machinery-ai-dev-con-seattle-wa-6fd59c785669860a1b94.js","167210315148319":"path---dplogs-behind-the-scenes-cbd7a3ce7fafed797827.js","199445844267045":"path---hello-world-react-064df80ee3ef90acc8cb.js","72525839730201":"path---arduino-rpm-photoelectric-encoders-e579b7a05ddd6a8340e9.js","51055887367808":"path---first-bot-first-steps-bf57da3c2eb54cd3d9f7.js","253769772827437":"path---passing-arrays-to-sprocs-3704240857e868a78ff3.js","266628614872821":"path---aop-with-postsharp-and-gibraltar-5c8d5019ccef938a86a1.js","281217300306919":"path---cs-unit-testing-private-methods-cd7c2632587ad9a45f15.js","68285458588220":"path---sharepoint-custom-redirection-httpmodule-68c65ec847bb16238024.js","192153295332971":"path---cs-unit-testing-ftp-with-resource-files-979d81312a7915973cc9.js","139934388839461":"path---cs-hostname-machinename-ipaddress-61cebbc12de698128b53.js","240471943383828":"path---install-sharepoint-2010-in-virtual-box-e27ec55ed41d7d1fa88e.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","142629428675168":"path---index-0e822d2a406dbadddbb4.js","135728916539164":"path---page-2-a0e39f21c11f6a62c5ab.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-2abfc667c37e6263bd01.js"}/*]]>*/</script><script>/*<![CDATA[*/!function(e,t,r){function n(){for(;d[0]&&"loaded"==d[0][f];)c=d.shift(),c[o]=!i.parentNode.insertBefore(c,i)}for(var s,a,c,d=[],i=e.scripts[0],o="onreadystatechange",f="readyState";s=r.shift();)a=e.createElement(t),"async"in i?(a.async=!1,e.head.appendChild(a)):i[f]?(d.push(a),a[o]=n):e.write("<"+t+' src="'+s+'" defer></'+t+">"),a.src=s}(document,"script",["/blog-gatsby/commons-8b3777e9b7196ecd4564.js","/blog-gatsby/app-930d4525f9a0912207a7.js","/blog-gatsby/path---cs-unit-testing-private-methods-cd7c2632587ad9a45f15.js","/blog-gatsby/component---src-templates-log-js-b4a7d74ce313b46c6d85.js","/blog-gatsby/component---src-layouts-index-js-2abfc667c37e6263bd01.js"])/*]]>*/</script></body></html>